<%@page import="java.time.format.DateTimeFormatter"%>
<%@page import="java.time.LocalDateTime"%>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<style>

.side-stick {
	width: 7px;
	height: 30px;
	position: absolute;
}

.form-control {
	border: none;
}

.schdul-input-title {
	border-bottom: var(- -bs-border-width) solid #dfe5ef;
}

.schdul-input {
	height: 100%;
}

.schedul-page-box {
	height: 80vh;
}

.modal-dialog {
  max-width: var(--bs-modal-width);
  margin-right: auto;
  margin-left: 450px;
  margin-top: 170px;
}

.select-color{
  margin: auto;
  gap: 10px;
  justify-content: space-around;
}

.modal-select-color{
  width : 300px;
}

.modal-backdrop {
  --bs-backdrop-bg: none;
}
#input-title{
  margin-left: 15px;
}

.form-control{
  color: #3d434d;
}

</style>
<div class="schedul-page-box row">
	<div class="col-yen-10 cal-nav">
		<div class="nav flex-column nav-pills mb-4 mb-md-0" id="v-pills-tab" role="tablist" aria-orientation="vertical">
			<a class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">
				<i class="fa-solid fa-plus"></i> 새 일정 등록
			</a>
			<br />
			<a class="nav-link" id="v-pills-all-tab" data-bs-toggle="pill" href="javascript:void(0);" onclick="getAllCal();" role="tab" aria-controls="v-pills-home" aria-selected="false"> 전체 일정 보기 </a>
			<a class="nav-link" id="v-pills-my-tab" data-bs-toggle="pill" href="javascript:void(0);" onclick="getMyCal();" role="tab" aria-controls="v-pills-profile" aria-selected="false"> 내 일정 </a>
			<a class="nav-link" id="v-pills-team-tab" data-bs-toggle="pill" href="javascript:void(0);" onclick="getDeptCal();" role="tab" aria-controls="v-pills-messages" aria-selected="false"> 부서 일정 </a>
			<a class="nav-link" id="v-pills-project-tab" data-bs-toggle="pill" href="javascript:void(0);" onclick="getProCal();" role="tab" aria-controls="v-pills-settings" aria-selected="false"> 프로젝트 </a>
			<a class="nav-link" id="v-pills-company-tab" data-bs-toggle="pill" href="javascript:void(0);" onclick="getComCal();" role="tab" aria-controls="v-pills-settings" aria-selected="false"> 사내 일정 </a>
		</div>
	</div>
	<div class="card schdul-input col-yen-50">
		<div class="card-body">
			<form action="" class="form-horizontal row">
				<div class="schdul-input-title input-group align-items-center">
					<span type="button" class="side-stick yen-red" data-bs-toggle="modal" data-bs-target="#modal-schedule-color"></span>
					<input id="input-title" type="text" class="form-control form-control-lg fs-8" placeholder="제목을 입력하세요.">
				</div>
				<!-- 모달 -->
				<div class="modal fade" id="modal-schedule-color" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" style="display: none;" aria-hidden="true">
					<div class="modal-dialog modal-select-color">
						<div class="modal-content">
							<div class="modal-header d-flex align-items-center">
								<h4 class="modal-title" id="myLargeModalLabel">색상</h4>
								<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							</div>
							<div class="modal-body row select-color">
								<div id="red" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-red" onclick="getColor(this)"></div>
								<div id="orange" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-orange" onclick="getColor(this)"></div>
								<div id="yellow" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-yellow" onclick="getColor(this)"></div>
								<div id="yellowgreen" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-yellowgreen" onclick="getColor(this)"></div>
								<div id="green" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-green" onclick="getColor(this)"></div>
								<div id="bluegreen" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-bluegreen" onclick="getColor(this)"></div>
								<div id="blue" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-blue" onclick="getColor(this)"></div>
								<div id="darkblue" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-darkblue" onclick="getColor(this)"></div>
								<div id="navy" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-navy" onclick="getColor(this)"></div>
								<div id="purple" class="d-flex justify-content-center align-items-center color-circle round-40 rounded-circle yen-purple" onclick="getColor(this)"></div>
							</div>
						</div>
					</div>
				</div>
				<!-- 모달 끝 -->
				<div class="input-group align-items-center">
					<i class="fa-regular fa-rectangle-list fs-5 mb-0"></i>
					<div class="col-yen-35">
						<select id="select-cal-type" onchange="schdulTypeChange()" class="form-control form-select" data-placeholder="Choose a Category" tabindex="1">
							<option value="My">내 캘린더</option>
							<option value="Dept">부서 일정</option>
							<option value="Project">프로젝트</option>
							<option value="Company">사내 일정</option>
						</select>
					</div>
					<div id="select-cal-project-container" class="col-yen-35" style="display: none;">
						<select id="select-cal-project" class="form-control form-select" data-placeholder="Choose a Category" tabindex="1">
							<option value="Category 1">내 캘린더</option>
							<option value="Category 2">부서 일정</option>
							<option value="Category 3">프로젝트</option>
							<option value="Category 4">사내 일정</option>
						</select>
					</div>
				</div>
				<div class="input-group align-items-center ">
					<i id="schedule-detail-icon-cal-1" class="fa-regular fa-calendar fs-5 mb-0"></i>
					<div class="col-yen-35">
						<input class="form-control" onchange="setMinTime()" type="datetime-local" value="${now }" min="${now }" id="schdul-bgnde">
					</div>
					<span>-</span>
					<div class="col-yen-35">
						<input class="form-control" type="datetime-local" value="${afterHour }" id="schdul-endde">
					</div>
				</div>
				<div class="input-group align-items-center">
					<i class="fa-regular fa-user fs-5 mb-0"></i>
					<div></div>
					<a>
						<i class="fa-regular fa-circle-plus"></i>
					</a>
				</div>
				<div class="input-group align-items-center">
					<i class="fa-light fa-location-dot fs-5 mb-0"></i>
					<div class="col-yen-35">
						<select id="select-place-type" class="form-control form-select" onchange="placeTypeChange()" data-placeholder="Choose a Category" tabindex="1">
							<option value="text">직접 입력</option>
							<option value="meetingroom">회의실 예약</option>
						</select>
					</div>
					<div id="input-place-text-container" class="col-yen-35">
						<input class="form-control" type="text" value="" placeholder="장소를 입력하세요." id="example-text-input">
					</div>
					<div id="select-meeting-room-container" class="col-yen-35" style="display: none;">
						<select id="select-meeting-room" class="form-control form-select" data-placeholder="Choose a Category" tabindex="1">
						</select>
					</div>
				</div>
				<div class="input-group align-items-center">
					<i class="fa-regular fa-bell fs-5 mb-0"></i>
					<div class="col-yen-35">
						<select class="form-control form-select" data-placeholder="Choose a Category" tabindex="1">
							<option value="none">없음</option>
							<option value="10min">10분 전 알림</option>
							<option value="30min">30분 전 알림</option>
							<option value="1hour">1시간 전 알림</option>
							<option value="1day">1일 전 알림</option>
							<option value="2day">2일 전 알림</option>
							<option value="1week">일주일 전 알림</option>
							<option value="custom">직접 입력</option>
						</select>
					</div>
					<div class="col-yen-35" style="display: none;">
						<select class="form-control form-select" data-placeholder="Choose a Category" tabindex="1">
							<option value="before0">당일</option>
							<option value="before1">1일전</option>
							<option value="before2">2일전</option>
							<option value="before3">3일전</option>
							<option value="before4">4일전</option>
							<option value="before5">5일전</option>
							<option value="before6">6일전</option>
							<option value="before7">7일전</option>
						</select>
					</div>
				</div>
				<div class="input-group align-items-center">
					<input type="text" class="form-control" placeholder="내용을 입력하세요.">
				</div>
			</form>
		</div>
	</div>
</div>
<script>
	
	var colorCircles = $(".color-circle");
	
	
	
	// 모달창 색상 원 선택 시 제목 옆 막대 색 변경
	function getColor(event) {
		for(var i=0; i<colorCircles.length; i++){
			colorCircles[i].innerHTML = "";
		}
		console.log(event);
		event.innerHTML = "<i class='fa-solid fa-check fs-7 text-white'></i>";
		$(".side-stick").attr("class","side-stick");
		$(".side-stick").addClass("yen-"+event.id);
	}
	
	// 캘린더 선택에서 프로젝트 선택 시 추가 선택
	function schdulTypeChange() {
		if($("#select-cal-type").val() == "Project"){
			$("#select-cal-project-container").show();
		}else{
			$("#select-cal-project-container").hide();			
		}
	}
	
	function setMinTime() {
		var selectedTime = $("#schdul-bgnde").val();
		$("#schdul-endde").attr("min",selectedTime);
	}
	
	function placeTypeChange() {
		console.log($("#select-place-type").val());
		if($("#select-place-type").val()=="text"){
			$("#select-meeting-room-container").hide();
			$("#input-place-text-container").show();
		}else{
			$("#input-place-text-container").hide();
			$("#select-meeting-room-container").show();
		}
	}
</script>