/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/gridstack@10.1.1/dist/gridstack.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/*!
 * GridStack 10.1.1
 * https://gridstackjs.com/
 *
 * Copyright (c) 2021-2022 Alain Dumesny
 * see root license https://github.com/gridstack/gridstack.js/tree/master/LICENSE
 */
import{GridStackEngine}from"./gridstack-engine";import{Utils,obsolete}from"./utils";import{gridDefaults,dragInDefaultOptions}from"./types";import{DDGridStack}from"./dd-gridstack";import{isTouch}from"./dd-touch";import{DDManager}from"./dd-manager";const dd=new DDGridStack;export*from"./types";export*from"./utils";export*from"./gridstack-engine";export*from"./dd-gridstack";class GridStack{static init(t={},e=".grid-stack"){if("undefined"==typeof document)return null;let i=GridStack.getGridElement(e);return i?(i.gridstack||(i.gridstack=new GridStack(i,Utils.cloneDeep(t))),i.gridstack):("string"==typeof e?console.error('GridStack.initAll() no grid was found with selector "'+e+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.'):console.error("GridStack.init() no grid element was passed."),null)}static initAll(t={},e=".grid-stack"){let i=[];return"undefined"==typeof document||(GridStack.getGridElements(e).forEach((e=>{e.gridstack||(e.gridstack=new GridStack(e,Utils.cloneDeep(t))),i.push(e.gridstack)})),0===i.length&&console.error('GridStack.initAll() no grid was found with selector "'+e+'" - element missing or wrong selector ?\nNote: ".grid-stack" is required for proper CSS styling and drag/drop, and is the default selector.')),i}static addGrid(t,e={}){if(!t)return null;let i=t;if(i.gridstack){const t=i.gridstack;return e&&(t.opts={...t.opts,...e}),void 0!==e.children&&t.load(e.children),t}if(!t.classList.contains("grid-stack")||GridStack.addRemoveCB)if(GridStack.addRemoveCB)i=GridStack.addRemoveCB(t,e,!0,!0);else{let s=document.implementation.createHTMLDocument("");s.body.innerHTML=`<div class="grid-stack ${e.class||""}"></div>`,i=s.body.children[0],t.appendChild(i)}return GridStack.init(e,i)}static registerEngine(t){GridStack.engineClass=t}get placeholder(){if(!this._placeholder){let t=document.createElement("div");t.className="placeholder-content",this.opts.placeholderText&&(t.innerHTML=this.opts.placeholderText),this._placeholder=document.createElement("div"),this._placeholder.classList.add(this.opts.placeholderClass,gridDefaults.itemClass,this.opts.itemClass),this.placeholder.appendChild(t)}return this._placeholder}constructor(t,e={}){this.el=t,this.opts=e,this._gsEventHandler={},this._extraDragRow=0,this.dragTransform={xScale:1,yScale:1,xOffset:0,yOffset:0},t.gridstack=this,e=e||{},t.classList.contains("grid-stack")||this.el.classList.add("grid-stack"),e.row&&(e.minRow=e.maxRow=e.row,delete e.row);let i=Utils.toNumber(t.getAttribute("gs-row"));"auto"===e.column&&delete e.column,void 0!==e.alwaysShowResizeHandle&&(e._alwaysShowResizeHandle=e.alwaysShowResizeHandle);let s=e.columnOpts?.breakpoints;const r=e;if(r.oneColumnModeDomSort&&(delete r.oneColumnModeDomSort,console.log("warning: Gridstack oneColumnModeDomSort no longer supported. Use GridStackOptions.columnOpts instead.")),r.oneColumnSize||!1===r.disableOneColumnMode){const t=r.oneColumnSize||768;delete r.oneColumnSize,delete r.disableOneColumnMode,e.columnOpts=e.columnOpts||{},s=e.columnOpts.breakpoints=e.columnOpts.breakpoints||[];let i=s.find((t=>1===t.c));i?i.w=t:(i={c:1,w:t},s.push(i,{c:12,w:t+1}))}const o=e.columnOpts;o&&(o.columnWidth||o.breakpoints?.length?o.columnMax=o.columnMax||12:(delete e.columnOpts,s=void 0)),s?.length>1&&s.sort(((t,e)=>(e.w||0)-(t.w||0)));let n={...Utils.cloneDeep(gridDefaults),column:Utils.toNumber(t.getAttribute("gs-column"))||gridDefaults.column,minRow:i||(Utils.toNumber(t.getAttribute("gs-min-row"))||gridDefaults.minRow),maxRow:i||(Utils.toNumber(t.getAttribute("gs-max-row"))||gridDefaults.maxRow),staticGrid:Utils.toBool(t.getAttribute("gs-static"))||gridDefaults.staticGrid,draggable:{handle:(e.handleClass?"."+e.handleClass:e.handle?e.handle:"")||gridDefaults.draggable.handle},removableOptions:{accept:e.itemClass||gridDefaults.removableOptions.accept,decline:gridDefaults.removableOptions.decline}};t.getAttribute("gs-animate")&&(n.animate=Utils.toBool(t.getAttribute("gs-animate"))),e=Utils.defaults(e,n),this._initMargin(),this.checkDynamicColumn(),this.el.classList.add("gs-"+e.column),"auto"===e.rtl&&(e.rtl="rtl"===t.style.direction),e.rtl&&this.el.classList.add("grid-stack-rtl");const l=this.el.parentElement?.parentElement;let a=l?.classList.contains(gridDefaults.itemClass)?l.gridstackNode:void 0;a&&(a.subGrid=this,this.parentGridItem=a,this.el.classList.add("grid-stack-nested"),a.el.classList.add("grid-stack-sub-grid")),this._isAutoCellHeight="auto"===e.cellHeight,this._isAutoCellHeight||"initial"===e.cellHeight?this.cellHeight(void 0,!1):("number"==typeof e.cellHeight&&e.cellHeightUnit&&e.cellHeightUnit!==gridDefaults.cellHeightUnit&&(e.cellHeight=e.cellHeight+e.cellHeightUnit,delete e.cellHeightUnit),this.cellHeight(e.cellHeight,!1)),"mobile"===e.alwaysShowResizeHandle&&(e.alwaysShowResizeHandle=isTouch),this._styleSheetClass="gs-id-"+GridStackEngine._idSeq++,this.el.classList.add(this._styleSheetClass),this._setStaticClass();let d=e.engineClass||GridStack.engineClass||GridStackEngine;if(this.engine=new d({column:this.getColumn(),float:e.float,maxRow:e.maxRow,onChange:t=>{let e=0;this.engine.nodes.forEach((t=>{e=Math.max(e,t.y+t.h)})),t.forEach((t=>{let e=t.el;e&&(t._removeDOM?(e&&e.remove(),delete t._removeDOM):this._writePosAttr(e,t))})),this._updateStyles(!1,e)}}),this._updateStyles(!1,0),e.auto&&(this.batchUpdate(),this.getGridItems().forEach((t=>this._prepareElement(t))),this.batchUpdate(!1)),e.children){let t=e.children;delete e.children,t.length&&this.load(t)}this.setAnimation(e.animate),e.subGridDynamic&&!DDManager.pauseDrag&&(DDManager.pauseDrag=!0),void 0!==e.draggable?.pause&&(DDManager.pauseDrag=e.draggable.pause),this._setupRemoveDrop(),this._setupAcceptWidget(),this._updateResizeEvent()}addWidget(t,e){let i,s;if("string"==typeof t){let e=document.implementation.createHTMLDocument("");e.body.innerHTML=t,i=e.body.children[0]}else if(0===arguments.length||1===arguments.length&&(void 0!==(r=t).el||void 0!==r.x||void 0!==r.y||void 0!==r.w||void 0!==r.h||void 0!==r.content))if(s=e=t,s?.el)i=s.el;else if(GridStack.addRemoveCB)i=GridStack.addRemoveCB(this.el,e,!0,!1);else{let t=e?.content||"",s=document.implementation.createHTMLDocument("");s.body.innerHTML=`<div class="grid-stack-item ${this.opts.itemClass||""}"><div class="grid-stack-item-content">${t}</div></div>`,i=s.body.children[0]}else i=t;var r;if(!i)return;if(s=i.gridstackNode,s&&i.parentElement===this.el&&this.engine.nodes.find((t=>t._id===s._id)))return i;let o=this._readAttr(i);return e=Utils.cloneDeep(e)||{},Utils.defaults(e,o),s=this.engine.prepareNode(e),this._writeAttr(i,e),this._insertNotAppend?this.el.prepend(i):this.el.appendChild(i),this.makeWidget(i,e),i}makeSubGrid(t,e,i,s=!0){let r,o=t.gridstackNode;if(o||(o=this.makeWidget(t).gridstackNode),o.subGrid?.el)return o.subGrid;let n,l=this;for(;l&&!r;)r=l.opts?.subGridOpts,l=l.parentGridItem?.grid;e=Utils.cloneDeep({...r||{},children:void 0,...e||o.subGridOpts||{}}),o.subGridOpts=e,"auto"===e.column&&(n=!0,e.column=Math.max(o.w||1,i?.w||1),delete e.columnOpts);let a,d,h=o.el.querySelector(".grid-stack-item-content");if(s){if(this._removeDD(o.el),d={...o,x:0,y:0},Utils.removeInternalForSave(d),delete d.subGridOpts,o.content&&(d.content=o.content,delete o.content),GridStack.addRemoveCB)a=GridStack.addRemoveCB(this.el,d,!0,!1);else{let t=document.implementation.createHTMLDocument("");t.body.innerHTML='<div class="grid-stack-item"></div>',a=t.body.children[0],a.appendChild(h),t.body.innerHTML='<div class="grid-stack-item-content"></div>',h=t.body.children[0],o.el.appendChild(h)}this._prepareDragDropByNode(o)}if(i){let t=n?e.column:o.w,s=o.h+i.h,r=o.el.style;r.transition="none",this.update(o.el,{w:t,h:s}),setTimeout((()=>r.transition=null))}let g=o.subGrid=GridStack.addGrid(h,e);return i?._moving&&(g._isTemp=!0),n&&(g._autoColumn=!0),s&&g.addWidget(a,d),i&&(i._moving?window.setTimeout((()=>Utils.simulateMouseEvent(i._event,"mouseenter",g.el)),0):g.addWidget(o.el,o)),g}removeAsSubGrid(t){let e=this.parentGridItem?.grid;e&&(e.batchUpdate(),e.removeWidget(this.parentGridItem.el,!0,!0),this.engine.nodes.forEach((t=>{t.x+=this.parentGridItem.x,t.y+=this.parentGridItem.y,e.addWidget(t.el,t)})),e.batchUpdate(!1),this.parentGridItem&&delete this.parentGridItem.subGrid,delete this.parentGridItem,t&&window.setTimeout((()=>Utils.simulateMouseEvent(t._event,"mouseenter",e.el)),0))}save(t=!0,e=!1,i=GridStack.saveCB){let s=this.engine.save(t,i);if(s.forEach((s=>{if(t&&s.el&&!s.subGrid&&!i){let t=s.el.querySelector(".grid-stack-item-content");s.content=t?t.innerHTML:void 0,s.content||delete s.content}else if(t||i||delete s.content,s.subGrid?.el){const r=s.subGrid.save(t,e,i);s.subGridOpts=e?r:{children:r},delete s.subGrid}delete s.el})),e){let t=Utils.cloneDeep(this.opts);t.marginBottom===t.marginTop&&t.marginRight===t.marginLeft&&t.marginTop===t.marginRight&&(t.margin=t.marginTop,delete t.marginTop,delete t.marginRight,delete t.marginBottom,delete t.marginLeft),t.rtl===("rtl"===this.el.style.direction)&&(t.rtl="auto"),this._isAutoCellHeight&&(t.cellHeight="auto"),this._autoColumn&&(t.column="auto");const e=t._alwaysShowResizeHandle;return delete t._alwaysShowResizeHandle,void 0!==e?t.alwaysShowResizeHandle=e:delete t.alwaysShowResizeHandle,Utils.removeInternalAndSame(t,gridDefaults),t.children=s,t}return s}load(t,e=GridStack.addRemoveCB||!0){t=Utils.cloneDeep(t);const i=this.getColumn(),s=t.some((t=>void 0!==t.x||void 0!==t.y));s&&(t=Utils.sort(t,-1,i)),this._insertNotAppend=s,t.some((t=>(t.x||0)+(t.w||1)>i))&&(this._ignoreLayoutsNodeChange=!0,this.engine.cacheLayout(t,12,!0));const r=GridStack.addRemoveCB;"function"==typeof e&&(GridStack.addRemoveCB=e);let o=[];this.batchUpdate();const n=!this.engine.nodes.length;if(n&&this.setAnimation(!1),e){[...this.engine.nodes].forEach((e=>{if(!e.id)return;Utils.find(t,e.id)||(GridStack.addRemoveCB&&GridStack.addRemoveCB(this.el,e,!1,!1),o.push(e),this.removeWidget(e.el,!0,!1))}))}let l=[];return this.engine.nodes=this.engine.nodes.filter((e=>!Utils.find(t,e.id)||(l.push(e),!1))),t.forEach((t=>{let i=Utils.find(l,t.id);if(i){if(Utils.shouldSizeToContent(i)&&(t.h=i.h),this.engine.nodeBoundFix(t),(t.autoPosition||void 0===t.x||void 0===t.y)&&(t.w=t.w||i.w,t.h=t.h||i.h,this.engine.findEmptyPosition(t)),this.engine.nodes.push(i),Utils.samePos(i,t)&&this.moveNode(i,{...t,forceCollide:!0}),this.update(i.el,t),t.subGridOpts?.children){let e=i.el.querySelector(".grid-stack");e&&e.gridstack&&(e.gridstack.load(t.subGridOpts.children),this._insertNotAppend=!0)}}else e&&this.addWidget(t)})),this.engine.removedNodes=o,this.batchUpdate(!1),delete this._ignoreLayoutsNodeChange,delete this._insertNotAppend,r?GridStack.addRemoveCB=r:delete GridStack.addRemoveCB,n&&this.opts.animate&&setTimeout((()=>this.setAnimation(this.opts.animate))),this}batchUpdate(t=!0){return this.engine.batchUpdate(t),t||(this._updateContainerHeight(),this._triggerRemoveEvent(),this._triggerAddEvent(),this._triggerChangeEvent()),this}getCellHeight(t=!1){if(this.opts.cellHeight&&"auto"!==this.opts.cellHeight&&(!t||!this.opts.cellHeightUnit||"px"===this.opts.cellHeightUnit))return this.opts.cellHeight;if("rem"===this.opts.cellHeightUnit)return this.opts.cellHeight*parseFloat(getComputedStyle(document.documentElement).fontSize);if("em"===this.opts.cellHeightUnit)return this.opts.cellHeight*parseFloat(getComputedStyle(this.el).fontSize);if("cm"===this.opts.cellHeightUnit)return this.opts.cellHeight*(96/2.54);if("mm"===this.opts.cellHeightUnit)return this.opts.cellHeight*(96/2.54)/10;let e=this.el.querySelector("."+this.opts.itemClass);if(e){let t=Utils.toNumber(e.getAttribute("gs-h"))||1;return Math.round(e.offsetHeight/t)}let i=parseInt(this.el.getAttribute("gs-current-row"));return i?Math.round(this.el.getBoundingClientRect().height/i):this.opts.cellHeight}cellHeight(t,e=!0){if(e&&void 0!==t&&this._isAutoCellHeight!==("auto"===t)&&(this._isAutoCellHeight="auto"===t,this._updateResizeEvent()),"initial"!==t&&"auto"!==t||(t=void 0),void 0===t){let e=-this.opts.marginRight-this.opts.marginLeft+this.opts.marginTop+this.opts.marginBottom;t=this.cellWidth()+e}let i=Utils.parseHeight(t);return this.opts.cellHeightUnit===i.unit&&this.opts.cellHeight===i.h||(this.opts.cellHeightUnit=i.unit,this.opts.cellHeight=i.h,this.resizeToContentCheck(),e&&this._updateStyles(!0)),this}cellWidth(){return this._widthOrContainer()/this.getColumn()}_widthOrContainer(t=!1){return t&&this.opts.columnOpts?.breakpointForWindow?window.innerWidth:this.el.clientWidth||this.el.parentElement.clientWidth||window.innerWidth}checkDynamicColumn(){const t=this.opts.columnOpts;if(!t||!t.columnWidth&&!t.breakpoints?.length)return!1;const e=this.getColumn();let i=e;const s=this._widthOrContainer(!0);if(t.columnWidth)i=Math.min(Math.round(s/t.columnWidth)||1,t.columnMax);else{i=t.columnMax;let r=0;for(;r<t.breakpoints.length&&s<=t.breakpoints[r].w;)i=t.breakpoints[r++].c||e}if(i!==e){const e=t.breakpoints?.find((t=>t.c===i));return this.column(i,e?.layout||t.layout),!0}return!1}compact(t="compact",e=!0){return this.engine.compact(t,e),this._triggerChangeEvent(),this}column(t,e="moveScale"){if(!t||t<1||this.opts.column===t)return this;let i=this.getColumn();return this.opts.column=t,this.engine?(this.engine.column=t,this.el.classList.remove("gs-"+i),this.el.classList.add("gs-"+t),this.engine.columnChanged(i,t,e),this._isAutoCellHeight&&this.cellHeight(),this.resizeToContentCheck(!0),this._ignoreLayoutsNodeChange=!0,this._triggerChangeEvent(),delete this._ignoreLayoutsNodeChange,this):this}getColumn(){return this.opts.column}getGridItems(){return Array.from(this.el.children).filter((t=>t.matches("."+this.opts.itemClass)&&!t.matches("."+this.opts.placeholderClass)))}destroy(t=!0){if(this.el)return this.offAll(),this._updateResizeEvent(!0),this.setStatic(!0,!1),this.setAnimation(!1),t?this.el.parentNode.removeChild(this.el):(this.removeAll(t),this.el.classList.remove(this._styleSheetClass),this.el.removeAttribute("gs-current-row")),this._removeStylesheet(),this.parentGridItem&&delete this.parentGridItem.subGrid,delete this.parentGridItem,delete this.opts,delete this._placeholder,delete this.engine,delete this.el.gridstack,delete this.el,this}float(t){return this.opts.float!==t&&(this.opts.float=this.engine.float=t,this._triggerChangeEvent()),this}getFloat(){return this.engine.float}getCellFromPixel(t,e=!1){let i,s=this.el.getBoundingClientRect();i=e?{top:s.top+document.documentElement.scrollTop,left:s.left}:{top:this.el.offsetTop,left:this.el.offsetLeft};let r=t.left-i.left,o=t.top-i.top,n=s.width/this.getColumn(),l=s.height/parseInt(this.el.getAttribute("gs-current-row"));return{x:Math.floor(r/n),y:Math.floor(o/l)}}getRow(){return Math.max(this.engine.getRow(),this.opts.minRow)}isAreaEmpty(t,e,i,s){return this.engine.isAreaEmpty(t,e,i,s)}makeWidget(t,e){let i=GridStack.getElement(t);this._prepareElement(i,!0,e);const s=i.gridstackNode;return this._updateContainerHeight(),s.subGridOpts&&this.makeSubGrid(i,s.subGridOpts,void 0,!1),1===this.opts.column&&(this._ignoreLayoutsNodeChange=!0),this._triggerAddEvent(),this._triggerChangeEvent(),delete this._ignoreLayoutsNodeChange,i}on(t,e){if(-1!==t.indexOf(" ")){return t.split(" ").forEach((t=>this.on(t,e))),this}if("change"===t||"added"===t||"removed"===t||"enable"===t||"disable"===t){let i="enable"===t||"disable"===t;this._gsEventHandler[t]=i?t=>e(t):t=>e(t,t.detail),this.el.addEventListener(t,this._gsEventHandler[t])}else"drag"===t||"dragstart"===t||"dragstop"===t||"resizestart"===t||"resize"===t||"resizestop"===t||"dropped"===t||"resizecontent"===t?this._gsEventHandler[t]=e:console.error("GridStack.on("+t+") event not supported");return this}off(t){if(-1!==t.indexOf(" ")){return t.split(" ").forEach((t=>this.off(t))),this}return"change"!==t&&"added"!==t&&"removed"!==t&&"enable"!==t&&"disable"!==t||this._gsEventHandler[t]&&this.el.removeEventListener(t,this._gsEventHandler[t]),delete this._gsEventHandler[t],this}offAll(){return Object.keys(this._gsEventHandler).forEach((t=>this.off(t))),this}removeWidget(t,e=!0,i=!0){return GridStack.getElements(t).forEach((t=>{if(t.parentElement&&t.parentElement!==this.el)return;let s=t.gridstackNode;s||(s=this.engine.nodes.find((e=>t===e.el))),s&&(GridStack.addRemoveCB&&GridStack.addRemoveCB(this.el,s,!1,!1),delete t.gridstackNode,this._removeDD(t),this.engine.removeNode(s,e,i),e&&t.parentElement&&t.remove())})),i&&(this._triggerRemoveEvent(),this._triggerChangeEvent()),this}removeAll(t=!0){return this.engine.nodes.forEach((t=>{delete t.el.gridstackNode,this._removeDD(t.el)})),this.engine.removeAll(t),this._triggerRemoveEvent(),this}setAnimation(t){return t?this.el.classList.add("grid-stack-animate"):this.el.classList.remove("grid-stack-animate"),this}hasAnimationCSS(){return this.el.classList.contains("grid-stack-animate")}setStatic(t,e=!0,i=!0){return!!this.opts.staticGrid===t||(t?this.opts.staticGrid=!0:delete this.opts.staticGrid,this._setupRemoveDrop(),this._setupAcceptWidget(),this.engine.nodes.forEach((s=>{this._prepareDragDropByNode(s),s.subGrid&&i&&s.subGrid.setStatic(t,e,i)})),e&&this._setStaticClass()),this}update(t,e){if(arguments.length>2){console.warn("gridstack.ts: `update(el, x, y, w, h)` is deprecated. Use `update(el, {x, w, content, ...})`. It will be removed soon");let i=arguments,s=1;return e={x:i[s++],y:i[s++],w:i[s++],h:i[s++]},this.update(t,e)}return GridStack.getElements(t).forEach((t=>{let i=t?.gridstackNode;if(!i)return;let s=Utils.cloneDeep(e);this.engine.nodeBoundFix(s),delete s.autoPosition,delete s.id;let r,o=["x","y","w","h"];if(o.some((t=>void 0!==s[t]&&s[t]!==i[t]))&&(r={},o.forEach((t=>{r[t]=void 0!==s[t]?s[t]:i[t],delete s[t]}))),!r&&(s.minW||s.minH||s.maxW||s.maxH)&&(r={}),void 0!==s.content){const e=t.querySelector(".grid-stack-item-content");e&&e.innerHTML!==s.content&&(e.innerHTML=s.content,i.subGrid?.el&&(e.appendChild(i.subGrid.el),i.subGrid.opts.styleInHead||i.subGrid._updateStyles(!0))),delete s.content}let n=!1,l=!1;for(const t in s)"_"!==t[0]&&i[t]!==s[t]&&(i[t]=s[t],n=!0,l=l||!this.opts.staticGrid&&("noResize"===t||"noMove"===t||"locked"===t));if(Utils.sanitizeMinMax(i),r){const t=void 0!==r.w&&r.w!==i.w;this.moveNode(i,r),this.resizeToContentCheck(t,i)}(r||n)&&this._writeAttr(t,i),l&&this._prepareDragDropByNode(i)})),this}moveNode(t,e){this.engine.cleanNodes().beginUpdate(t).moveNode(t,e),this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate()}resizeToContent(t){if(!t)return;if(t.classList.remove("size-to-content-max"),!t.clientHeight)return;const e=t.gridstackNode;if(!e)return;const i=e.grid;if(!i||t.parentElement!==i.el)return;const s=i.getCellHeight(!0);if(!s)return;let r,o=e.h?e.h*s:t.clientHeight;if(e.resizeToContentParent&&(r=t.querySelector(e.resizeToContentParent)),r||(r=t.querySelector(GridStack.resizeToContentParent)),!r)return;const n=t.clientHeight-r.clientHeight,l=e.h?e.h*s-n:r.clientHeight;let a;if(e.subGrid)a=e.subGrid.getRow()*e.subGrid.getCellHeight(!0);else{const t=r.firstElementChild;if(!t)return void console.error(`Error: GridStack.resizeToContent() widget id:${e.id} '${GridStack.resizeToContentParent}'.firstElementChild is null, make sure to have a div like container. Skipping sizing.`);a=t.getBoundingClientRect().height||l}if(l===a)return;o+=a-l;let d=Math.ceil(o/s);const h=Number.isInteger(e.sizeToContent)?e.sizeToContent:0;h&&d>h&&(d=h,t.classList.add("size-to-content-max")),e.minH&&d<e.minH?d=e.minH:e.maxH&&d>e.maxH&&(d=e.maxH),d!==e.h&&(i._ignoreLayoutsNodeChange=!0,i.moveNode(e,{h:d}),delete i._ignoreLayoutsNodeChange)}resizeToContentCBCheck(t){GridStack.resizeToContentCB?GridStack.resizeToContentCB(t):this.resizeToContent(t)}margin(t){if(!("string"==typeof t&&t.split(" ").length>1)){let e=Utils.parseHeight(t);if(this.opts.marginUnit===e.unit&&this.opts.margin===e.h)return}return this.opts.margin=t,this.opts.marginTop=this.opts.marginBottom=this.opts.marginLeft=this.opts.marginRight=void 0,this._initMargin(),this._updateStyles(!0),this}getMargin(){return this.opts.margin}willItFit(t){if(arguments.length>1){console.warn("gridstack.ts: `willItFit(x,y,w,h,autoPosition)` is deprecated. Use `willItFit({x, y,...})`. It will be removed soon");let t=arguments,e=0,i={x:t[e++],y:t[e++],w:t[e++],h:t[e++],autoPosition:t[e++]};return this.willItFit(i)}return this.engine.willItFit(t)}_triggerChangeEvent(){if(this.engine.batchMode)return this;let t=this.engine.getDirtyNodes(!0);return t&&t.length&&(this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(t),this._triggerEvent("change",t)),this.engine.saveInitial(),this}_triggerAddEvent(){return this.engine.batchMode||this.engine.addedNodes?.length&&(this._ignoreLayoutsNodeChange||this.engine.layoutsNodesChange(this.engine.addedNodes),this.engine.addedNodes.forEach((t=>{delete t._dirty})),this._triggerEvent("added",this.engine.addedNodes),this.engine.addedNodes=[]),this}_triggerRemoveEvent(){return this.engine.batchMode||this.engine.removedNodes?.length&&(this._triggerEvent("removed",this.engine.removedNodes),this.engine.removedNodes=[]),this}_triggerEvent(t,e){let i=e?new CustomEvent(t,{bubbles:!1,detail:e}):new Event(t);return this.el.dispatchEvent(i),this}_removeStylesheet(){if(this._styles){const t=this.opts.styleInHead?void 0:this.el.parentNode;Utils.removeStylesheet(this._styleSheetClass,t),delete this._styles}return this}_updateStyles(t=!1,e){if(t&&this._removeStylesheet(),void 0===e&&(e=this.getRow()),this._updateContainerHeight(),0===this.opts.cellHeight)return this;let i=this.opts.cellHeight,s=this.opts.cellHeightUnit,r=`.${this._styleSheetClass} > .${this.opts.itemClass}`;if(!this._styles){const t=this.opts.styleInHead?void 0:this.el.parentNode;if(this._styles=Utils.createStylesheet(this._styleSheetClass,t,{nonce:this.opts.nonce}),!this._styles)return this;this._styles._max=0,Utils.addCSSRule(this._styles,r,`height: ${i}${s}`);let e=this.opts.marginTop+this.opts.marginUnit,o=this.opts.marginBottom+this.opts.marginUnit,n=this.opts.marginRight+this.opts.marginUnit,l=this.opts.marginLeft+this.opts.marginUnit,a=`${r} > .grid-stack-item-content`,d=`.${this._styleSheetClass} > .grid-stack-placeholder > .placeholder-content`;Utils.addCSSRule(this._styles,a,`top: ${e}; right: ${n}; bottom: ${o}; left: ${l};`),Utils.addCSSRule(this._styles,d,`top: ${e}; right: ${n}; bottom: ${o}; left: ${l};`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-n`,`top: ${e};`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-s`,`bottom: ${o}`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-ne`,`right: ${n}`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-e`,`right: ${n}`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-se`,`right: ${n}; bottom: ${o}`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-nw`,`left: ${l}`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-w`,`left: ${l}`),Utils.addCSSRule(this._styles,`${r} > .ui-resizable-sw`,`left: ${l}; bottom: ${o}`)}if((e=e||this._styles._max)>this._styles._max){let t=t=>i*t+s;for(let i=this._styles._max+1;i<=e;i++)Utils.addCSSRule(this._styles,`${r}[gs-y="${i}"]`,`top: ${t(i)}`),Utils.addCSSRule(this._styles,`${r}[gs-h="${i+1}"]`,`height: ${t(i+1)}`);this._styles._max=e}return this}_updateContainerHeight(){if(!this.engine||this.engine.batchMode)return this;const t=this.parentGridItem;let e=this.getRow()+this._extraDragRow;const i=this.opts.cellHeight,s=this.opts.cellHeightUnit;if(!i)return this;if(!t){const t=Utils.parseHeight(getComputedStyle(this.el).minHeight);if(t.h>0&&t.unit===s){const s=Math.floor(t.h/i);e<s&&(e=s)}}return this.el.setAttribute("gs-current-row",String(e)),this.el.style.removeProperty("min-height"),this.el.style.removeProperty("height"),e&&(this.el.style[t?"minHeight":"height"]=e*i+s),t&&!t.grid.engine.batchMode&&Utils.shouldSizeToContent(t)&&t.grid.resizeToContentCBCheck(t.el),this}_prepareElement(t,e=!1,i){i=i||this._readAttr(t),t.gridstackNode=i,i.el=t,i.grid=this,i=this.engine.addNode(i,e),this._writeAttr(t,i),t.classList.add(gridDefaults.itemClass,this.opts.itemClass);const s=Utils.shouldSizeToContent(i);return s?t.classList.add("size-to-content"):t.classList.remove("size-to-content"),s&&this.resizeToContentCheck(!1,i),this._prepareDragDropByNode(i),this}_writePosAttr(t,e){return void 0!==e.x&&null!==e.x&&t.setAttribute("gs-x",String(e.x)),void 0!==e.y&&null!==e.y&&t.setAttribute("gs-y",String(e.y)),e.w>1?t.setAttribute("gs-w",String(e.w)):t.removeAttribute("gs-w"),e.h>1?t.setAttribute("gs-h",String(e.h)):t.removeAttribute("gs-h"),this}_writeAttr(t,e){if(!e)return this;this._writePosAttr(t,e);let i={autoPosition:"gs-auto-position",noResize:"gs-no-resize",noMove:"gs-no-move",locked:"gs-locked",id:"gs-id"};for(const s in i)e[s]?t.setAttribute(i[s],String(e[s])):t.removeAttribute(i[s]);return this}_readAttr(t,e=!0){let i={};i.x=Utils.toNumber(t.getAttribute("gs-x")),i.y=Utils.toNumber(t.getAttribute("gs-y")),i.w=Utils.toNumber(t.getAttribute("gs-w")),i.h=Utils.toNumber(t.getAttribute("gs-h")),i.autoPosition=Utils.toBool(t.getAttribute("gs-auto-position")),i.noResize=Utils.toBool(t.getAttribute("gs-no-resize")),i.noMove=Utils.toBool(t.getAttribute("gs-no-move")),i.locked=Utils.toBool(t.getAttribute("gs-locked")),i.id=t.getAttribute("gs-id"),i.maxW=Utils.toNumber(t.getAttribute("gs-max-w")),i.minW=Utils.toNumber(t.getAttribute("gs-min-w")),i.maxH=Utils.toNumber(t.getAttribute("gs-max-h")),i.minH=Utils.toNumber(t.getAttribute("gs-min-h")),e&&(1===i.w&&t.removeAttribute("gs-w"),1===i.h&&t.removeAttribute("gs-h"),i.maxW&&t.removeAttribute("gs-max-w"),i.minW&&t.removeAttribute("gs-min-w"),i.maxH&&t.removeAttribute("gs-max-h"),i.minH&&t.removeAttribute("gs-min-h"));for(const t in i){if(!i.hasOwnProperty(t))return;i[t]||0===i[t]||delete i[t]}return i}_setStaticClass(){let t=["grid-stack-static"];return this.opts.staticGrid?(this.el.classList.add(...t),this.el.setAttribute("gs-static","true")):(this.el.classList.remove(...t),this.el.removeAttribute("gs-static")),this}onResize(){if(!this.el?.clientWidth)return;if(this.prevWidth===this.el.clientWidth)return;this.prevWidth=this.el.clientWidth,this.batchUpdate();let t=!1;return this._autoColumn&&this.parentGridItem?this.opts.column!==this.parentGridItem.w&&(this.column(this.parentGridItem.w,"none"),t=!0):t=this.checkDynamicColumn(),this._isAutoCellHeight&&this.cellHeight(),this.engine.nodes.forEach((t=>{t.subGrid&&t.subGrid.onResize()})),this._skipInitialResize||this.resizeToContentCheck(t),delete this._skipInitialResize,this.batchUpdate(!1),this}resizeToContentCheck(t=!1,e=void 0){if(this.engine){if(t&&this.hasAnimationCSS())return setTimeout((()=>this.resizeToContentCheck(!1,e)),310);if(e)Utils.shouldSizeToContent(e)&&this.resizeToContentCBCheck(e.el);else if(this.engine.nodes.some((t=>Utils.shouldSizeToContent(t)))){const t=[...this.engine.nodes];this.batchUpdate(),t.forEach((t=>{Utils.shouldSizeToContent(t)&&this.resizeToContentCBCheck(t.el)})),this.batchUpdate(!1)}this._gsEventHandler.resizecontent&&this._gsEventHandler.resizecontent(null,e?[e]:this.engine.nodes)}}_updateResizeEvent(t=!1){const e=!this.parentGridItem&&(this._isAutoCellHeight||this.opts.sizeToContent||this.opts.columnOpts||this.engine.nodes.find((t=>t.sizeToContent)));return t||!e||this.resizeObserver?!t&&e||!this.resizeObserver||(this.resizeObserver.disconnect(),delete this.resizeObserver,delete this._sizeThrottle):(this._sizeThrottle=Utils.throttle((()=>this.onResize()),this.opts.cellHeightThrottle),this.resizeObserver=new ResizeObserver((()=>this._sizeThrottle())),this.resizeObserver.observe(this.el),this._skipInitialResize=!0),this}static getElement(t=".grid-stack-item"){return Utils.getElement(t)}static getElements(t=".grid-stack-item"){return Utils.getElements(t)}static getGridElement(t){return GridStack.getElement(t)}static getGridElements(t){return Utils.getElements(t)}_initMargin(){let t,e=0,i=[];return"string"==typeof this.opts.margin&&(i=this.opts.margin.split(" ")),2===i.length?(this.opts.marginTop=this.opts.marginBottom=i[0],this.opts.marginLeft=this.opts.marginRight=i[1]):4===i.length?(this.opts.marginTop=i[0],this.opts.marginRight=i[1],this.opts.marginBottom=i[2],this.opts.marginLeft=i[3]):(t=Utils.parseHeight(this.opts.margin),this.opts.marginUnit=t.unit,e=this.opts.margin=t.h),void 0===this.opts.marginTop?this.opts.marginTop=e:(t=Utils.parseHeight(this.opts.marginTop),this.opts.marginTop=t.h,delete this.opts.margin),void 0===this.opts.marginBottom?this.opts.marginBottom=e:(t=Utils.parseHeight(this.opts.marginBottom),this.opts.marginBottom=t.h,delete this.opts.margin),void 0===this.opts.marginRight?this.opts.marginRight=e:(t=Utils.parseHeight(this.opts.marginRight),this.opts.marginRight=t.h,delete this.opts.margin),void 0===this.opts.marginLeft?this.opts.marginLeft=e:(t=Utils.parseHeight(this.opts.marginLeft),this.opts.marginLeft=t.h,delete this.opts.margin),this.opts.marginUnit=t.unit,this.opts.marginTop===this.opts.marginBottom&&this.opts.marginLeft===this.opts.marginRight&&this.opts.marginTop===this.opts.marginRight&&(this.opts.margin=this.opts.marginTop),this}static getDD(){return dd}static setupDragIn(t,e,i=document){void 0!==e?.pause&&(DDManager.pauseDrag=e.pause),e={...dragInDefaultOptions,...e||{}};let s="string"==typeof t?Utils.getElements(t,i):t;s.length&&s?.forEach((t=>{dd.isDraggable(t)||dd.dragIn(t,e)}))}movable(t,e){return this.opts.staticGrid||GridStack.getElements(t).forEach((t=>{const i=t.gridstackNode;i&&(e?delete i.noMove:i.noMove=!0,this._prepareDragDropByNode(i))})),this}resizable(t,e){return this.opts.staticGrid||GridStack.getElements(t).forEach((t=>{let i=t.gridstackNode;i&&(e?delete i.noResize:i.noResize=!0,this._prepareDragDropByNode(i))})),this}disable(t=!0){if(!this.opts.staticGrid)return this.enableMove(!1,t),this.enableResize(!1,t),this._triggerEvent("disable"),this}enable(t=!0){if(!this.opts.staticGrid)return this.enableMove(!0,t),this.enableResize(!0,t),this._triggerEvent("enable"),this}enableMove(t,e=!0){return this.opts.staticGrid||(t?delete this.opts.disableDrag:this.opts.disableDrag=!0,this.engine.nodes.forEach((i=>{this._prepareDragDropByNode(i),i.subGrid&&e&&i.subGrid.enableMove(t,e)}))),this}enableResize(t,e=!0){return this.opts.staticGrid||(t?delete this.opts.disableResize:this.opts.disableResize=!0,this.engine.nodes.forEach((i=>{this._prepareDragDropByNode(i),i.subGrid&&e&&i.subGrid.enableResize(t,e)}))),this}_removeDD(t){return dd.draggable(t,"destroy").resizable(t,"destroy"),t.gridstackNode&&delete t.gridstackNode._initDD,delete t.ddElement,this}_setupAcceptWidget(){if(this.opts.staticGrid||!this.opts.acceptWidgets&&!this.opts.removable)return dd.droppable(this.el,"destroy"),this;let t,e,i=(i,s,r)=>{let o=s.gridstackNode;if(!o)return;if(r=r||s,!o.grid?.el){r.style.transform=`scale(${1/this.dragTransform.xScale},${1/this.dragTransform.yScale})`;const t=r.getBoundingClientRect();r.style.left=t.x+(this.dragTransform.xScale-1)*(i.clientX-t.x)/this.dragTransform.xScale+"px",r.style.top=t.y+(this.dragTransform.yScale-1)*(i.clientY-t.y)/this.dragTransform.yScale+"px",r.style.transformOrigin="0px 0px"}let n=this.el.getBoundingClientRect(),{top:l,left:a}=r.getBoundingClientRect();a-=n.left,l-=n.top;let d={position:{top:l*this.dragTransform.xScale,left:a*this.dragTransform.yScale}};if(o._temporaryRemoved){if(o.x=Math.max(0,Math.round(a/e)),o.y=Math.max(0,Math.round(l/t)),delete o.autoPosition,this.engine.nodeBoundFix(o),!this.engine.willItFit(o)){if(o.autoPosition=!0,!this.engine.willItFit(o))return void dd.off(s,"drag");o._willFitPos&&(Utils.copyPos(o,o._willFitPos),delete o._willFitPos)}this._onStartMoving(r,i,d,o,e,t)}else this._dragOrResize(r,i,d,o,e,t)};return dd.droppable(this.el,{accept:t=>{let e=t.gridstackNode;if(e?.grid===this)return!0;if(!this.opts.acceptWidgets)return!1;let i=!0;if("function"==typeof this.opts.acceptWidgets)i=this.opts.acceptWidgets(t);else{let e=!0===this.opts.acceptWidgets?".grid-stack-item":this.opts.acceptWidgets;i=t.matches(e)}if(i&&e&&this.opts.maxRow){let t={w:e.w,h:e.h,minW:e.minW,minH:e.minH};i=this.engine.willItFit(t)}return i}}).on(this.el,"dropover",((s,r,o)=>{let n=r.gridstackNode;if(n?.grid===this&&!n._temporaryRemoved)return!1;if(n?.grid&&n.grid!==this&&!n._temporaryRemoved){n.grid._leave(r,o)}e=this.cellWidth(),t=this.getCellHeight(!0),n||(n=this._readAttr(r,!1)),n.grid||(n._isExternal=!0,r.gridstackNode=n),o=o||r;let l=n.w||Math.round(o.offsetWidth/e)||1,a=n.h||Math.round(o.offsetHeight/t)||1;return n.grid&&n.grid!==this?(r._gridstackNodeOrig||(r._gridstackNodeOrig=n),r.gridstackNode=n={...n,w:l,h:a,grid:this},delete n.x,delete n.y,this.engine.cleanupNode(n).nodeBoundFix(n),n._initDD=n._isExternal=n._temporaryRemoved=!0):(n.w=l,n.h=a,n._temporaryRemoved=!0),this._itemRemoving(n.el,!1),dd.on(r,"drag",i),i(s,r,o),!1})).on(this.el,"dropout",((t,e,i)=>{let s=e.gridstackNode;return!!s&&(s.grid&&s.grid!==this||(this._leave(e,i),this._isTemp&&this.removeAsSubGrid(s)),!1)})).on(this.el,"drop",((t,e,i)=>{let s=e.gridstackNode;if(s?.grid===this&&!s._isExternal)return!1;const r=!!this.placeholder.parentElement;this.placeholder.remove();const o=r&&this.opts.animate;o&&this.setAnimation(!1);let n=e._gridstackNodeOrig;if(delete e._gridstackNodeOrig,r&&n?.grid&&n.grid!==this){let t=n.grid;t.engine.removeNodeFromLayoutCache(n),t.engine.removedNodes.push(n),t._triggerRemoveEvent()._triggerChangeEvent(),t.parentGridItem&&!t.engine.nodes.length&&t.opts.subGridDynamic&&t.removeAsSubGrid()}if(!s)return!1;if(r&&(this.engine.cleanupNode(s),s.grid=this),delete s.grid._isTemp,dd.off(e,"drag"),i!==e?(i.remove(),e.gridstackNode=n,r&&(e=e.cloneNode(!0))):(e.remove(),this._removeDD(e)),!r)return!1;e.gridstackNode=s,s.el=e;let l=s.subGrid?.el?.gridstack;return Utils.copyPos(s,this._readAttr(this.placeholder)),Utils.removePositioningStyles(e),this.el.appendChild(e),this._prepareElement(e,!0,s),l&&(l.parentGridItem=s,l.opts.styleInHead||l._updateStyles(!0)),this._updateContainerHeight(),this.engine.addedNodes.push(s),this._triggerAddEvent(),this._triggerChangeEvent(),this.engine.endUpdate(),this._gsEventHandler.dropped&&this._gsEventHandler.dropped({...t,type:"dropped"},n&&n.grid?n:void 0,s),o&&setTimeout((()=>this.setAnimation(this.opts.animate))),!1})),this}_itemRemoving(t,e){let i=t?t.gridstackNode:void 0;i&&i.grid&&!t.classList.contains(this.opts.removableOptions.decline)&&(e?i._isAboutToRemove=!0:delete i._isAboutToRemove,e?t.classList.add("grid-stack-item-removing"):t.classList.remove("grid-stack-item-removing"))}_setupRemoveDrop(){if(!this.opts.staticGrid&&"string"==typeof this.opts.removable){let t=document.querySelector(this.opts.removable);if(!t)return this;dd.isDroppable(t)||dd.droppable(t,this.opts.removableOptions).on(t,"dropover",((t,e)=>this._itemRemoving(e,!0))).on(t,"dropout",((t,e)=>this._itemRemoving(e,!1)))}return this}_prepareDragDropByNode(t){let e=t.el;const i=t.noMove||this.opts.disableDrag,s=t.noResize||this.opts.disableResize;if(this.opts.staticGrid||i&&s)return t._initDD&&(this._removeDD(e),delete t._initDD),e.classList.add("ui-draggable-disabled","ui-resizable-disabled"),this;if(!t._initDD){let i,s,r=(r,o)=>{this._gsEventHandler[r.type]&&this._gsEventHandler[r.type](r,r.target),i=this.cellWidth(),s=this.getCellHeight(!0),this._onStartMoving(e,r,o,t,i,s)},o=(r,o)=>{this._dragOrResize(e,r,o,t,i,s)},n=i=>{this.placeholder.remove(),delete t._moving,delete t._event,delete t._lastTried;const s=t.w!==t._orig.w;let r=i.target;if(r.gridstackNode&&r.gridstackNode.grid===this){if(t.el=r,t._isAboutToRemove){let s=e.gridstackNode.grid;s._gsEventHandler[i.type]&&s._gsEventHandler[i.type](i,r),s.engine.nodes.push(t),s.removeWidget(e,!0,!0)}else Utils.removePositioningStyles(r),t._temporaryRemoved?(Utils.copyPos(t,t._orig),this._writePosAttr(r,t),this.engine.addNode(t)):this._writePosAttr(r,t),this._gsEventHandler[i.type]&&this._gsEventHandler[i.type](i,r);this._extraDragRow=0,this._updateContainerHeight(),this._triggerChangeEvent(),this.engine.endUpdate(),"resizestop"===i.type&&(Number.isInteger(t.sizeToContent)&&(t.sizeToContent=t.h),this.resizeToContentCheck(s,t))}};dd.draggable(e,{start:r,stop:n,drag:o}).resizable(e,{start:r,stop:n,resize:o}),t._initDD=!0}return dd.draggable(e,i?"disable":"enable").resizable(e,s?"disable":"enable"),this}_onStartMoving(t,e,i,s,r,o){if(this.engine.cleanNodes().beginUpdate(s),this._writePosAttr(this.placeholder,s),this.el.appendChild(this.placeholder),s.grid?.el)this.dragTransform=Utils.getValuesFromTransformedElement(t);else if(this.placeholder&&this.placeholder.closest(".grid-stack")){const t=this.placeholder.closest(".grid-stack");this.dragTransform=Utils.getValuesFromTransformedElement(t)}else this.dragTransform={xScale:1,xOffset:0,yScale:1,yOffset:0};s.el=this.placeholder,s._lastUiPosition=i.position,s._prevYPix=i.position.top,s._moving="dragstart"===e.type,delete s._lastTried,"dropover"===e.type&&s._temporaryRemoved&&(this.engine.addNode(s),s._moving=!0),this.engine.cacheRects(r,o,this.opts.marginTop,this.opts.marginRight,this.opts.marginBottom,this.opts.marginLeft),"resizestart"===e.type&&(dd.resizable(t,"option","minWidth",r*(s.minW||1)).resizable(t,"option","minHeight",o*(s.minH||1)),s.maxW&&dd.resizable(t,"option","maxWidth",r*s.maxW),s.maxH&&dd.resizable(t,"option","maxHeight",o*s.maxH))}_dragOrResize(t,e,i,s,r,o){let n,l={...s._orig},a=this.opts.marginLeft,d=this.opts.marginRight,h=this.opts.marginTop,g=this.opts.marginBottom,c=Math.round(.1*o),m=Math.round(.1*r);if(a=Math.min(a,m),d=Math.min(d,m),h=Math.min(h,c),g=Math.min(g,c),"drag"===e.type){if(s._temporaryRemoved)return;let e=i.position.top-s._prevYPix;s._prevYPix=i.position.top,!1!==this.opts.draggable.scroll&&Utils.updateScrollPosition(t,i.position,e);let n=i.position.left+(i.position.left>s._lastUiPosition.left?-d:a),c=i.position.top+(i.position.top>s._lastUiPosition.top?-g:h);l.x=Math.round(n/r),l.y=Math.round(c/o);let m=this._extraDragRow;if(this.engine.collide(s,l)){let t=this.getRow(),e=Math.max(0,l.y+s.h-t);this.opts.maxRow&&t+e>this.opts.maxRow&&(e=Math.max(0,this.opts.maxRow-t)),this._extraDragRow=e}else this._extraDragRow=0;if(this._extraDragRow!==m&&this._updateContainerHeight(),s.x===l.x&&s.y===l.y)return}else if("resize"===e.type){if(l.x<0)return;if(Utils.updateScrollResize(e,t,o),l.w=Math.round((i.size.width-a)/r),l.h=Math.round((i.size.height-h)/o),s.w===l.w&&s.h===l.h)return;if(s._lastTried&&s._lastTried.w===l.w&&s._lastTried.h===l.h)return;let d=i.position.left+a,g=i.position.top+h;l.x=Math.round(d/r),l.y=Math.round(g/o),n=!0}s._event=e,s._lastTried=l;let p={x:i.position.left+a,y:i.position.top+h,w:(i.size?i.size.width:s.w*r)-a-d,h:(i.size?i.size.height:s.h*o)-h-g};if(this.engine.moveNodeCheck(s,{...l,cellWidth:r,cellHeight:o,rect:p,resizing:n})){s._lastUiPosition=i.position,this.engine.cacheRects(r,o,h,d,g,a),delete s._skipDown,n&&s.subGrid&&s.subGrid.onResize(),this._extraDragRow=0,this._updateContainerHeight();let t=e.target;this._writePosAttr(t,s),this._gsEventHandler[e.type]&&this._gsEventHandler[e.type](e,t)}}_leave(t,e){let i=t.gridstackNode;i&&((e=e||t).style.transform="scale(1)",dd.off(t,"drag"),i._temporaryRemoved||(i._temporaryRemoved=!0,this.engine.removeNode(i),i.el=i._isExternal&&e?e:t,!0===this.opts.removable&&this._itemRemoving(t,!0),t._gridstackNodeOrig?(t.gridstackNode=t._gridstackNodeOrig,delete t._gridstackNodeOrig):i._isExternal&&(delete i.el,delete t.gridstackNode,this.engine.restoreInitial())))}commit(){return obsolete(this,this.batchUpdate(!1),"commit","batchUpdate","5.2"),this}}GridStack.resizeToContentParent=".grid-stack-item-content",GridStack.Utils=Utils,GridStack.Engine=GridStackEngine,GridStack.GDRev="10.1.1";export{GridStack};
//# sourceMappingURL=/sm/8e97dc929584c3755b04ce10811da18274f47cc9da8296689c021cc3afb0f255.map