package kr.or.ddit.groupware.controller.common;

import java.util.List;

import javax.inject.Inject;

import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.multipart.MultipartFile;

import kr.or.ddit.groupware.service.attach.IAttachFileService;
import kr.or.ddit.groupware.util.FileUtil;
import kr.or.ddit.groupware.util.TableCode;
import kr.or.ddit.groupware.vo.AttachFileGroupVO;

/**
 * 메인 컨트롤러
 * @author <strong>이명문</strong>
 * @version 1.0
 * @see MainController
 */
@Controller
@RequestMapping("/")
public class MainController {
	
	@Inject
	private FileUtil fileUtil;
	
	@Inject
	private IAttachFileService attachFileService;
	
	@PreAuthorize("hasAnyRole('ROLE_MEMBER', 'ROLE_ADMIN')")
	@GetMapping("")
	public String testView() {
		return "main/main";
	}
	
	@GetMapping("/upload")
	public String upload() {
		AttachFileGroupVO attachFileGroupVO = attachFileService.getAttachFileGroup(9);
		return "main/upload";
	}
	
	@PostMapping("/upload")
	public ResponseEntity<String> uploadPost(List<MultipartFile> files) {
		List<String> saveFileNames = fileUtil.saveUploadFile(files, TableCode.BOARD);
		return ResponseEntity.ok(saveFileNames.toString());
	}
	
	@RequestMapping("/calendar")
	public String calendar() {
		return "main/calendar";
	}
	
	@RequestMapping("/chat")
	public String chat() {
		return "main/chat";
	}
	
	@RequestMapping("/kanban")
	public String kanban() {
		return "main/kanban";
	}
	
	@RequestMapping("/note")
	public String note() {
		return "main/note";
	}
	
	@RequestMapping("/email")
	public String email() {
		return "main/email";
	}
	
	@RequestMapping("/addresstable")
	public String contactTable() {
		return "main/addressTable";
	}
	
	@RequestMapping("/addressbook")
	public String contactList() {
		return "main/addressList";
	}
	
	@RequestMapping("/profile")
	public String profile() {
		return "main/profile";
	}
	
	@RequestMapping("/reservation")
	public String reservation() {
		return "main/reservation";
	}
	
	@RequestMapping("/temp")
	public String temp() {
		return "main/calendar";
	}
}
