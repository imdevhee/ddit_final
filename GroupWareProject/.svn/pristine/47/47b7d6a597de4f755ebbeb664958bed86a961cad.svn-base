<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/project/css/themes/default/style.min.css">
<style>
.doc-sidebar {
	position: relative;
	display: flex;
	flex-direction: column;
	height: 100%; /* 추가 */
}

.doc-wrapper {
	width: 250px;
	/* background-color: aqua; */
	height: 1000px;
	border-right: 1px solid #dfe5ef;
}
</style>
<header>
	<div class="container-fluid">
		<h4>문서 양식 관리</h4>
		<hr>
	</div>
</header>
<!-- 메인 컨텐츠 -->
<div class="container-fluid">
	<div class="row">
		<!-- 왼쪽 사이드바 -->
		<div class="col-lg-2 col-md-4">
			<div class="doc-wrapper">
				<div class="left-part border-end w-15 flex-shrink-0 d-none d-lg-block"></div>
				<div class="doc-sidebar">
					<!-- 검색 입력 창 -->
					<div class="searchInput d-flex align-items-center me-3">
						<input type="text" id="oragn-search" class="form-control rounded-0" maxlength="20" placeholder="문서명">
						<button type="button" class="btn btn-dark bg-dark rounded-0">
							<i class="fa-light fa-magnifying-glass fa-md fa-fw"></i>
						</button>
					</div>
					<!-- 트리 -->
					<div id="tree" style="margin-top: 20px;"></div>
					<div class="simplebar-track simplebar-vertical" style="visibility: visible;">
						<div class="simplebar-scrollbar" style="height: 681px; transform: translate3d(0px, 0px, 0px); display: block;"></div>
					</div>
				</div>
			</div>
		</div>
		<!-- 오른쪽 컨텐츠 -->
		<div class="col-lg">
			<div class="row">
				<div class="col">
					<div class="buttonWrpper d-flex justify-content-end" >
						<button>양식 추가</button>
						<button>수정</button>
						<button>삭제</button>
					</div>
					왼쪽반
				</div>
				<div class="col">오른쪽반</div>
			</div>
		</div>
	</div>
</div>




<script src="${pageContext.request.contextPath }/resources/project/js/source/jstree.min.js"></script>
<script type="text/javascript">
	$(document).ready(
			function() {
				$.ajax({
					url : "/documents/selectdoclist",
					type : "GET",
					dataType : "json",
					success : function(documentsList) {
						// 서버에서 전달받은 JSON 데이터 사용
						var treeData = convertToJstreeFormat(documentsList);
						// jstree 초기화
						$('#tree').jstree({
							"plugins" : [ "search", "wholerow" ],
							"search" : {
								"show_only_matches" : true,
								"show_only_matches_children" : true,
							},
							'core' : {
								'data' : treeData
							}
						});
					}
				});

				$('#oragn-search').on(
						'propertychange change keyup paste input', function() {
							$('#jsTree').jstree(true).search($(this).val());
						})
			});

	// JSON 데이터를 jstree의 형식으로 변환하는 함수
	function convertToJstreeFormat(documentsList) {
		var treeData = [];
		for (var i = 0; i < documentsList.length; i++) {
			var document = documentsList[i];
			treeData.push({
				"id" : document.id,
				"text" : document.text,
				"docCn" : document.docCn,
				"parent" : document.parent
			});
		}
		return treeData;
	}
</script>
</html>